@model Maps.Entities.DetailsMapViewModel
@{
    ViewBag.Title = "Details";
}

@if (!Html.ViewData.ModelState.IsValid)
{
    <div class="row">
        <div class="col card">
            @Html.ValidationSummary(false, "", new { @class = "text-danger" })
        </div>
    </div>
}
<div class="row h-100">
    <div class="col-md-3 p-0" id="sidebar">
        @Html.Partial("Sidebar", Model)
    </div>
    <div class="col-md-9 border p-0 h-100">  
        <nav class="bg-white">
            <ul class="nav nav-tabs" id="nav-tab" role="tablist">
                <li class="nav-item">
                    <a class="nav-link" id="nav-map-tab" data-toggle="tab" href="#nav-map" role="tab" aria-controls="nav-map" aria-selected="true">Map</a>
                </li>
                <li class="nav-item dropdown">
                    <a onclick="tableDropdownLinkClick()" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Data tables</a>
                    <div id="tableDropdown" class="dropdown-menu">
                        @Html.Partial("../Layer/TableDropdown", Model.DropdownLayerItems)
                    </div>
                </li>
                <li class="nav-item dropdown">
                    <a onclick="chartDropdownLinkClick()" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Data charts</a>
                    <div id="chartDropdown" class="dropdown-menu">
                        @Html.Partial("../Layer/TableDropdown", Model.DropdownLayerItems)
                    </div>
                </li>
            </ul>
        </nav>
        <div class="tab-content">
            <div class="tab-pane fade show" id="nav-map" role="tabpanel" aria-labelledby="nav-map-tab">MAPA</div>
            <div class="tab-pane fade" id="nav-table" role="tabpanel" aria-labelledby="nav-table-tab"></div>
            <div class="tab-pane fade" id="nav-chart" role="tabpanel" aria-labelledby="nav-chart-tab"></div>
        </div>
    </div>
</div>


<script>
    function tableDropdownLinkClick() {
        var request = $.ajax({
            type: "get",
            url: "../../Layer/TableDropdown",
            data: {
                mapId: "@Model.Id"
            }
        });
        request.done(function (msg) {
            $("#tableDropdown").html(msg);
        });
    }

     function chartDropdownLinkClick() {
        var request = $.ajax({
            type: "get",
            url: "../../Layer/ChartDropdown",
            data: {
                mapId: "@Model.Id"
            }
        });
        request.done(function (msg) {
            $("#chartDropdown").html(msg);
        });
    }

    function dataLoadComplete(id) {
        console.log(id);
        $('#collapse' + id).collapse('show')     
    }
</script>


